#!/bin/sh

CIP=$COUGAAR_INSTALL_PATH
if [ -z $CIP ]; then
  echo \$COUGAAR_INSTALL_PATH not set
  exit -1
fi

cat <<EOF
Warning, this script takes a while (~30 minutes+)!

EOF
echo -n "Starting: "
date

echo "Transforming java.*"
for x in io net rmi util; do
  ./transform_jar java${x}patch
done

echo "Transforming lib/*.jar"
for x in lib/*.jar; do
  ./transform_jar $x
done

echo "Transforming sys/*.jar"
cat <<EOF
  The following errors are expected:
    icu4j:        two class files are corrupt
    jena:         missing jars (sesame, antlr, sleepycat)
    juddi:        missing jars (axis)
    log4j:        missing jars (jms, jmx)
    openmap:      missing jars (j3d)
    tomcat_40:    missing jars (jmx)
    vishnuServer: missing jars (vishnu, util)
  These errors and related NPEs can be ignored, since the classes
  that depend upon these missing jars will never be loaded at
  runtime.
EOF
for x in sys/*.jar; do
  ./transform_jar $x
done

echo -n "Finished: "
date

